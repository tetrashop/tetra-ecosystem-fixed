<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„ - Tetra Ecosystem</title>
    <style>
        :root {
            --primary: #00ff88;
            --secondary: #302b63;
            --dark: #0f0c29;
            --light: #ffffff;
            --accent: #ff00ff;
            --warning: #ffaa00;
            --danger: #ff4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, var(--dark), var(--secondary));
            color: var(--light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }

        .navbar {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-link {
            color: var(--light);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        .nav-link.active {
            background: var(--primary);
            color: var(--dark);
            font-weight: bold;
        }

        .module-header {
            background: linear-gradient(135deg, rgba(0,255,136,0.1), rgba(255,0,255,0.1));
            padding: 3rem 2rem;
            text-align: center;
            border-bottom: 2px solid var(--accent);
        }

        .module-title {
            font-size: 3rem;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .module-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .module-container {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .module-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            min-height: 600px;
        }

        .module-sidebar {
            background: rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .module-info {
            text-align: center;
            margin-bottom: 2rem;
        }

        .module-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .module-name {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .module-version {
            color: var(--primary);
            font-size: 0.9rem;
        }

        .module-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-item {
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--dark);
        }

        .btn-primary:hover {
            background: #00cc66;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,255,136,0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: var(--dark);
        }

        .module-content {
            background: rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .content-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 1rem;
        }

        .content-tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            color: var(--light);
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .content-tab.active {
            background: var(--primary);
            color: var(--dark);
        }

        .content-tab:hover:not(.active) {
            background: rgba(255,255,255,0.1);
        }

        .tab-panel {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .execution-form {
            background: rgba(255,255,255,0.05);
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .form-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 1rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            color: var(--light);
            font-size: 1rem;
            backdrop-filter: blur(10px);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .results-container {
            background: rgba(255,255,255,0.05);
            padding: 2rem;
            border-radius: 15px;
            margin-top: 2rem;
        }

        .results-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .results-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .execution-info {
            display: flex;
            gap: 2rem;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .results-content {
            background: rgba(0,0,0,0.3);
            padding: 1.5rem;
            border-radius: 10px;
            min-height: 200px;
            font-family: monospace;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .history-item {
            background: rgba(255,255,255,0.05);
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        .history-time {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 0.5rem;
        }

        .history-action {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .history-result {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .docs-content {
            line-height: 1.8;
        }

        .docs-section {
            margin-bottom: 2rem;
        }

        .docs-title {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .code-block {
            background: rgba(0,0,0,0.3);
            padding: 1rem;
            border-radius: 10px;
            font-family: monospace;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .feature-item {
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feature-icon {
            color: var(--primary);
        }

        .loading-spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid var(--primary);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(0,255,136,0.2);
            color: var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .module-container {
                padding: 1rem;
            }

            .module-layout {
                grid-template-columns: 1fr;
            }

            .content-tabs {
                flex-wrap: wrap;
            }

            .feature-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            ğŸ† Tetra Ecosystem
        </div>
        <div class="nav-links">
            <a href="/dashboard" class="nav-link">ğŸ  Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a>
            <a href="/modules" class="nav-link">ğŸ—ï¸ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§</a>
            <a href="/wallet" class="nav-link">ğŸ’° Ú©ÛŒÙ Ù¾ÙˆÙ„</a>
            <a href="#" class="nav-link" onclick="logout()">ğŸšª Ø®Ø±ÙˆØ¬</a>
        </div>
    </nav>

    <div class="module-header">
        <h1 class="module-title" id="moduleTitle">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</h1>
        <p class="module-subtitle" id="moduleDescription">Ù…Ø§Ú˜ÙˆÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø³ÛŒØ³ØªÙ…</p>
        <div class="module-version" id="moduleVersion">ÙˆØ±Ú˜Ù†: Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
    </div>

    <div class="module-container">
        <div class="module-layout">
            <!-- Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ù…Ø§Ú˜ÙˆÙ„ -->
            <div class="module-sidebar">
                <div class="module-info">
                    <div class="module-icon" id="moduleIcon">ğŸ—ï¸</div>
                    <div class="module-name" id="sidebarModuleName">Ù…Ø§Ú˜ÙˆÙ„</div>
                    <div class="module-version" id="sidebarVersion">ÙˆØ±Ú˜Ù†: -</div>
                </div>

                <div class="module-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="statPerformance">0%</div>
                        <div class="stat-label">Ø¹Ù…Ù„Ú©Ø±Ø¯</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statRequests">0</div>
                        <div class="stat-label">Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statUptime">100%</div>
                        <div class="stat-label">Ø¢Ù¾ØªØ§ÛŒÙ…</div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="executeModule()">
                        ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„
                    </button>
                    <button class="btn btn-outline" onclick="showTab('history')">
                        ğŸ“Š ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§Ø¬Ø±Ø§
                    </button>
                    <button class="btn btn-outline" onclick="showTab('docs')">
                        ğŸ“š Ù…Ø³ØªÙ†Ø¯Ø§Øª
                    </button>
                </div>

                <div class="success-badge" id="purchaseBadge" style="display: none;">
                    âœ… Ù…Ø§Ú˜ÙˆÙ„ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡
                </div>
            </div>

            <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
            <div class="module-content">
                <div class="content-tabs">
                    <button class="content-tab active" onclick="showContentTab('execute')">
                        âš¡ Ø§Ø¬Ø±Ø§
                    </button>
                    <button class="content-tab" onclick="showContentTab('history')">
                        ğŸ“‹ ØªØ§Ø±ÛŒØ®Ú†Ù‡
                    </button>
                    <button class="content-tab" onclick="showContentTab('docs')">
                        ğŸ“– Ù…Ø³ØªÙ†Ø¯Ø§Øª
                    </button>
                    <button class="content-tab" onclick="showContentTab('settings')">
                        âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
                    </button>
                </div>

                <!-- ØªØ¨ Ø§Ø¬Ø±Ø§ -->
                <div id="execute-tab" class="tab-panel active">
                    <div class="execution-form">
                        <h3 class="form-title">Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„</h3>
                        <form id="executionForm">
                            <div class="form-group">
                                <label class="form-label">Ù†ÙˆØ¹ Ø¹Ù…Ù„ÛŒØ§Øª</label>
                                <select class="form-select" id="operationType">
                                    <option value="analyze">ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡</option>
                                    <option value="process">Ù¾Ø±Ø¯Ø§Ø²Ø´</option>
                                    <option value="generate">ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§</option>
                                    <option value="optimize">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Ø¯Ø§Ø¯Ù‡ ÙˆØ±ÙˆØ¯ÛŒ</label>
                                <textarea class="form-textarea" id="inputData" placeholder="Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                    <div>
                                        <label style="font-size: 0.9rem; display: block; margin-bottom: 0.5rem;">Ø³Ø·Ø­ Ø¯Ù‚Øª</label>
                                        <select class="form-select" id="precisionLevel">
                                            <option value="low">Ù¾Ø§ÛŒÛŒÙ†</option>
                                            <option value="medium" selected>Ù…ØªÙˆØ³Ø·</option>
                                            <option value="high">Ø¨Ø§Ù„Ø§</option>
                                            <option value="max">Ø­Ø¯Ø§Ú©Ø«Ø±</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 0.9rem; display: block; margin-bottom: 0.5rem;">Ø³Ø±Ø¹Øª Ù¾Ø±Ø¯Ø§Ø²Ø´</label>
                                        <select class="form-select" id="processingSpeed">
                                            <option value="slow">Ú©Ù†Ø¯</option>
                                            <option value="normal" selected>Ù…Ø¹Ù…ÙˆÙ„ÛŒ</option>
                                            <option value="fast">Ø³Ø±ÛŒØ¹</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <button type="button" class="btn btn-primary" onclick="executeModule()" style="width: 100%;">
                                ğŸš€ Ø´Ø±ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø²Ø´
                            </button>
                        </form>
                    </div>

                    <div class="results-container" id="resultsContainer" style="display: none;">
                        <div class="results-header">
                            <h3 class="results-title">Ù†ØªØ§ÛŒØ¬ Ø§Ø¬Ø±Ø§</h3>
                            <div class="execution-info">
                                <span id="executionTime">Ø²Ù…Ø§Ù†: -</span>
                                <span id="executionStatus">ÙˆØ¶Ø¹ÛŒØª: -</span>
                            </div>
                        </div>
                        <div class="results-content" id="resultsContent">
                            <!-- Ù†ØªØ§ÛŒØ¬åœ¨è¿™é‡Œæ˜¾ç¤º -->
                        </div>
                    </div>
                </div>

                <!-- ØªØ¨ ØªØ§Ø±ÛŒØ®Ú†Ù‡ -->
                <div id="history-tab" class="tab-panel">
                    <h3 style="margin-bottom: 1.5rem; color: var(--primary);">ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§Ø¬Ø±Ø§Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ</h3>
                    <div class="history-list" id="historyList">
                        <!-- ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§Ø¬Ø±Ø§åœ¨è¿™é‡ŒåŠ è½½ -->
                    </div>
                </div>

                <!-- ØªØ¨ Ù…Ø³ØªÙ†Ø¯Ø§Øª -->
                <div id="docs-tab" class="tab-panel">
                    <div class="docs-content" id="docsContent">
                        <!-- Ù…Ø³ØªÙ†Ø¯Ø§Øªåœ¨è¿™é‡ŒåŠ è½½ -->
                    </div>
                </div>

                <!-- ØªØ¨ ØªÙ†Ø¸ÛŒÙ…Ø§Øª -->
                <div id="settings-tab" class="tab-panel">
                    <h3 style="margin-bottom: 1.5rem; color: var(--primary);">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø§Ú˜ÙˆÙ„</h3>
                    <div class="execution-form">
                        <div class="form-group">
                            <label class="form-label">Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…Ø§Ù‡Ø§Ù†Ù‡</label>
                            <select class="form-select" id="usageLimit">
                                <option value="1000">Û±Û°Û°Û° Ø¯Ø±Ø®ÙˆØ§Ø³Øª</option>
                                <option value="5000" selected>ÛµÛ°Û°Û° Ø¯Ø±Ø®ÙˆØ§Ø³Øª</option>
                                <option value="10000">Û±Û°Û°Û°Û° Ø¯Ø±Ø®ÙˆØ§Ø³Øª</option>
                                <option value="unlimited">Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†ØªØ§ÛŒØ¬</label>
                            <select class="form-select" id="resultStorage">
                                <option value="7days">Û· Ø±ÙˆØ²</option>
                                <option value="30days" selected>Û³Û° Ø±ÙˆØ²</option>
                                <option value="90days">Û¹Û° Ø±ÙˆØ²</option>
                                <option value="forever">Ù‡Ù…ÛŒØ´Ù‡</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="autoUpdate" checked>
                                Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù…Ø§Ú˜ÙˆÙ„
                            </label>
                        </div>

                        <button class="btn btn-primary" onclick="saveSettings()">
                            ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const token = localStorage.getItem('tetra_token');
        const urlParams = new URLSearchParams(window.location.search);
        const moduleId = window.location.pathname.split('/').pop();
        
        if (!token) {
            window.location.href = '/login';
        }

        let currentModule = null;
        let executionHistory = [];

        async function loadModuleData() {
            try {
                const response = await fetch(`/api/modules/${moduleId}`, {
                    headers: {
                        'Authorization': 'Bearer ' + token
                    }
                });

                const data = await response.json();

                if (data.success) {
                    currentModule = data.module;
                    updateModuleDisplay();
                    
                    if (!currentModule.isPurchased) {
                        showPurchaseWarning();
                    }
                } else {
                    window.location.href = '/modules';
                }
            } catch (error) {
                console.error('Error loading module data:', error);
                window.location.href = '/modules';
            }
        }

        function updateModuleDisplay() {
            // Ø¢Ù¾Ø¯ÛŒØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§Ú˜ÙˆÙ„
            document.getElementById('moduleTitle').textContent = currentModule.name;
            document.getElementById('moduleDescription').textContent = currentModule.description;
            document.getElementById('moduleVersion').textContent = `ÙˆØ±Ú˜Ù†: ${currentModule.version}`;
            
            document.getElementById('sidebarModuleName').textContent = currentModule.name;
            document.getElementById('sidebarVersion').textContent = `ÙˆØ±Ú˜Ù†: ${currentModule.version}`;
            document.getElementById('moduleIcon').textContent = getModuleIcon(currentModule.id);

            // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
            document.getElementById('statPerformance').textContent = `${currentModule.performance}%`;
            document.getElementById('statRequests').textContent = currentModule.instance?.statistics?.requests || 0;
            
            if (currentModule.isPurchased) {
                document.getElementById('purchaseBadge').style.display = 'flex';
            }

            // Ø¢Ù¾Ø¯ÛŒØª Ù…Ø³ØªÙ†Ø¯Ø§Øª
            updateDocumentation();
            
            // Ù„ÙˆØ¯ ØªØ§Ø±ÛŒØ®Ú†Ù‡
            loadExecutionHistory();
        }

        function getModuleIcon(moduleId) {
            const icons = {
                'ai-quantum-core': 'ğŸ¤–',
                'quantum-writer-pro': 'ğŸ“',
                'nlp-master': 'ğŸ§ ',
                'quantum-wallet': 'ğŸ’¼',
                'security-shield': 'ğŸ›¡ï¸',
                'quantum-analytics': 'ğŸ“Š',
                'trading-master': 'ğŸ¤–',
                'blockchain-explorer': 'ğŸ”—',
                'api-orchestrator': 'âš™ï¸',
                'quantum-visualizer': 'ğŸ”®',
                'neural-network-pro': 'ğŸ§ ',
                'crypto-vault': 'ğŸ’°'
            };
            return icons[moduleId] || 'ğŸ—ï¸';
        }

        function updateDocumentation() {
            const docsContent = document.getElementById('docsContent');
            
            docsContent.innerHTML = `
                <div class="docs-section">
                    <h3 class="docs-title">ğŸ“– Ù…Ø¹Ø±ÙÛŒ Ù…Ø§Ú˜ÙˆÙ„</h3>
                    <p>${currentModule.description}</p>
                    <div class="feature-list">
                        ${currentModule.features.map(feature => `
                            <div class="feature-item">
                                <span class="feature-icon">âœ“</span>
                                <span>${feature}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="docs-section">
                    <h3 class="docs-title">âš¡ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡</h3>
                    <p>Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ù…Ø§Ú˜ÙˆÙ„ØŒ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø±Ø§ Ø¯Ø± ØªØ¨ "Ø§Ø¬Ø±Ø§" ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø²Ø´" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</p>
                    
                    <div class="code-block">
// Ù…Ø«Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ø§Ú˜ÙˆÙ„ ${currentModule.name}
const parameters = {
    operation: "analyze",
    data: "Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ",
    precision: "high"
};

const result = await module.execute(parameters);
                    </div>
                </div>

                <div class="docs-section">
                    <h3 class="docs-title">ğŸ”§ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ</h3>
                    <p><strong>Ù†ÙˆØ¹ Ø¹Ù…Ù„ÛŒØ§Øª:</strong> ØªØ­Ù„ÛŒÙ„ØŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ØŒ ØªÙˆÙ„ÛŒØ¯ ÛŒØ§ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ</p>
                    <p><strong>Ø¯Ø§Ø¯Ù‡ ÙˆØ±ÙˆØ¯ÛŒ:</strong> Ù…ØªÙ†ØŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ø¯Ø¯ÛŒ ÛŒØ§ ÙØ§ÛŒÙ„</p>
                    <p><strong>Ø³Ø·Ø­ Ø¯Ù‚Øª:</strong> ØªÙ†Ø¸ÛŒÙ… Ø¯Ù‚Øª Ù¾Ø±Ø¯Ø§Ø²Ø´</p>
                </div>

                <div class="docs-section">
                    <h3 class="docs-title">ğŸ“Š Ø®Ø±ÙˆØ¬ÛŒâ€ŒÙ‡Ø§</h3>
                    <p>Ù†ØªØ§ÛŒØ¬ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø± Ù‚Ø§Ù„Ø¨ JSON Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ø´Ø§Ù…Ù„:</p>
                    <ul>
                        <li>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø´Ø¯Ù‡</li>
                        <li>Ø¢Ù…Ø§Ø± Ùˆ Ù…ØªØ±ÛŒÚ©â€ŒÙ‡Ø§</li>
                        <li>Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§</li>
                        <li>ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„ÛŒØ§Øª</li>
                    </ul>
                </div>
            `;
        }

        async function executeModule() {
            if (!currentModule.isPurchased) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ø§ÛŒÙ† Ù…Ø§Ú˜ÙˆÙ„ Ø±Ø§ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯.');
                return;
            }

            const operationType = document.getElementById('operationType').value;
            const inputData = document.getElementById('inputData').value;
            const precisionLevel = document.getElementById('precisionLevel').value;
            const processingSpeed = document.getElementById('processingSpeed').value;

            // Ù†Ù…Ø§ÛŒØ´ Ø§Ø³Ù¾ÛŒÙ†Ø±
            const resultsContainer = document.getElementById('resultsContainer');
            const resultsContent = document.getElementById('resultsContent');
            resultsContainer.style.display = 'block';
            resultsContent.innerHTML = '<div class="loading-spinner"></div>';

            document.getElementById('executionTime').textContent = 'Ø²Ù…Ø§Ù†: Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´...';
            document.getElementById('executionStatus').textContent = 'ÙˆØ¶Ø¹ÛŒØª: Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§';

            try {
                const response = await fetch(`/api/modules/${moduleId}/execute`, {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: operationType,
                        parameters: {
                            data: inputData,
                            precision: precisionLevel,
                            speed: processingSpeed,
                            timestamp: new Date().toISOString()
                        }
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
                    resultsContent.innerHTML = formatResults(data.result);
                    document.getElementById('executionTime').textContent = 
                        `Ø²Ù…Ø§Ù†: ${new Date().toLocaleString('fa-IR')}`;
                    document.getElementById('executionStatus').textContent = 'ÙˆØ¶Ø¹ÛŒØª: Ù…ÙˆÙÙ‚';

                    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ ØªØ§Ø±ÛŒØ®Ú†Ù‡
                    addToHistory(operationType, data.result);
                    
                    showNotification('Ù…Ø§Ú˜ÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¬Ø±Ø§ Ø´Ø¯', 'success');
                } else {
                    resultsContent.innerHTML = `Ø®Ø·Ø§: ${data.error}`;
                    document.getElementById('executionStatus').textContent = 'ÙˆØ¶Ø¹ÛŒØª: Ù†Ø§Ù…ÙˆÙÙ‚';
                    showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„', 'error');
                }
            } catch (error) {
                resultsContent.innerHTML = `Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±: ${error.message}`;
                document.getElementById('executionStatus').textContent = 'ÙˆØ¶Ø¹ÛŒØª: Ø®Ø·Ø§';
                showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±', 'error');
            }
        }

        function formatResults(result) {
            if (typeof result === 'string') {
                return result;
            }

            return JSON.stringify(result, null, 2);
        }

        function loadExecutionHistory() {
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§Ø¬Ø±Ø§
            executionHistory = [
                {
                    id: 1,
                    action: 'analyze',
                    result: 'ØªØ­Ù„ÛŒÙ„ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯',
                    timestamp: new Date(Date.now() - 3600000).toISOString()
                },
                {
                    id: 2,
                    action: 'process',
                    result: 'Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯',
                    timestamp: new Date(Date.now() - 7200000).toISOString()
                },
                {
                    id: 3,
                    action: 'generate',
                    result: 'Ù…Ø­ØªÙˆØ§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯',
                    timestamp: new Date(Date.now() - 10800000).toISOString()
                }
            ];

            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyList = document.getElementById('historyList');
            
            historyList.innerHTML = executionHistory.map(entry => `
                <div class="history-item">
                    <div class="history-time">
                        ${new Date(entry.timestamp).toLocaleString('fa-IR')}
                    </div>
                    <div class="history-action">
                        Ø¹Ù…Ù„ÛŒØ§Øª: ${getActionText(entry.action)}
                    </div>
                    <div class="history-result">
                        ${entry.result}
                    </div>
                </div>
            `).join('');
        }

        function addToHistory(action, result) {
            const newEntry = {
                id: executionHistory.length + 1,
                action: action,
                result: typeof result === 'string' ? result : 'Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ²',
                timestamp: new Date().toISOString()
            };

            executionHistory.unshift(newEntry);
            updateHistoryDisplay();
        }

        function getActionText(action) {
            const actions = {
                'analyze': 'ØªØ­Ù„ÛŒÙ„',
                'process': 'Ù¾Ø±Ø¯Ø§Ø²Ø´',
                'generate': 'ØªÙˆÙ„ÛŒØ¯',
                'optimize': 'Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ'
            };
            return actions[action] || action;
        }

        function showContentTab(tabName) {
            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… ØªØ¨â€ŒÙ‡Ø§
            document.querySelectorAll('.tab-panel').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.content-tab').forEach(button => {
                button.classList.remove('active');
            });

            // Ù†Ù…Ø§ÛŒØ´ ØªØ¨ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        function showPurchaseWarning() {
            const resultsContainer = document.getElementById('resultsContainer');
            resultsContainer.style.display = 'block';
            document.getElementById('resultsContent').innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ”’</div>
                    <h3 style="color: var(--warning); margin-bottom: 1rem;">Ù…Ø§Ú˜ÙˆÙ„ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡</h3>
                    <p>Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ù…Ø§Ú˜ÙˆÙ„ØŒ Ø¨Ø§ÛŒØ¯ Ø¢Ù† Ø±Ø§ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯.</p>
                    <button class="btn btn-primary" onclick="purchaseModule()" style="margin-top: 1rem;">
                        ğŸ›’ Ø®Ø±ÛŒØ¯ Ù…Ø§Ú˜ÙˆÙ„ - ${currentModule.price.toLocaleString()} TETRA
                    </button>
                </div>
            `;
        }

        async function purchaseModule() {
            try {
                const response = await fetch(`/api/modules/${moduleId}/purchase`, {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();

                if (data.success) {
                    showNotification('Ù…Ø§Ú˜ÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯!', 'success');
                    currentModule.isPurchased = true;
                    document.getElementById('purchaseBadge').style.display = 'flex';
                    document.getElementById('resultsContainer').style.display = 'none';
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø®Ø±ÛŒØ¯ Ù…Ø§Ú˜ÙˆÙ„', 'error');
            }
        }

        function saveSettings() {
            showNotification('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯', 'success');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'error' ? 'var(--danger)' : 
                           type === 'success' ? 'var(--success)' : 'var(--primary)'};
                color: ${type === 'error' ? 'white' : 'black'};
                padding: 1rem 1.5rem;
                border-radius: 10px;
                z-index: 10000;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        function logout() {
            localStorage.removeItem('tetra_token');
            window.location.href = '/login';
        }

        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', loadModuleData);
    </script>
</body>
</html>
